<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <script
    src="https://code.jquery.com/jquery-3.5.1.js"
    integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>
<!--    <script src="{{ url_for('static', filename='js3/year.js') }}" type="text/javascript"></script>-->
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" >Year</a>
      <form class="d-flex">
        <select name="which">
          <option value="all" selected>all</option>
          <option value="2020">2020</option>
          <option value="2021">2021</option>
        </select>
      </form>
    </div>
  </div>
</nav>

<table  class="table table-striped" class="for-table" border="1">
    <thead class="bg-dark text-white">
        <tr>
            <th scope="col"></th>
            <th scope="col">年分</th>
            <th scope="col">季度</th>
            <th scope="col">動畫</th>
            <th scope="col">導演</th>
            <th scope="col">製作公司</th>
        </tr>
    </thead>
    <tbody id="test"></tbody>
</table>

<div class="container">
    <div class="row justify-content-between">
        <button type="button" class=" col-1 btn btn-secondary" id="pre" disabled = true>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-circle-fill" viewBox="0 0 16 16">
              <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/>
            </svg>
        </button>
        <button type="button" class="col-1 btn btn-secondary" id="next" >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16">
              <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>
            </svg>
        </button>
    </div>
</div>
<script>
    var page=0;
    var len;
    function next() {
        page+=50;
        //alert(page);
        var button1 = document.getElementById('pre');
        if(page<=0) {
		    button1.disabled = true;
        }
        else{
            button1.disabled = false;
        }
        var button2 = document.getElementById('next');
        if(page>=(len-50)) {
		    button2.disabled = true;
        }
        else{
            button2.disabled = false;
        }
        //console.log(page);
        drawTable();
    }
    function pre() {
        page-=50;
        //alert(page);
        var button1 = document.getElementById('pre');
        if(page<=0) {
		    button1.disabled = true;
        }
        else{
            button1.disabled = false;
        }
        var button2 = document.getElementById('next');
        if(page>=(len-50)) {
		    button2.disabled = true;
        }
        else{
            button2.disabled = false;
        }
        //console.log(page);
        drawTable();
    }
    var newdata =[];

    //console.log("aa");
    init({{ data|safe }});
    drawTable();

    function init(data){
        //console.log("bb");
        len = data.length;
        var k=0;
        for (var i =0 ; i < len; i++) {
            if(data[i][1]==2021) newdata.push(data[i]);
        }
        for (var i =0 ; i < len; i++) {
            newdata.push(data[i]);
            if(data[i][1]==2021) break;
        }
        //console.log(newdata);
    }
    function drawTable(data){
        var forTable = document.querySelector('tbody');
        for (var i =page ; i < page+50; i++) {
            if(i>len) break;
            forTable.innerHTML +=
                '<tr>' +
                    '<th scope="row">'+(i+1)+'</th>'+
                    '<td>' + newdata[i][1] + '</td>' +
                    '<td>' + newdata[i][2] + '</td>' +
                    '<td>' + newdata[i][0] + '</td>' +
                    '<td>' + newdata[i][3] + '</td>' +
                    '<td>' + newdata[i][4] + '</td>' +
                '</tr>';
        }
    }

    $(document).ready(function(){
      $("#next").click(function(){
        $("#test").empty();
        next();
      });
    });
    $(document).ready(function(){
      $("#pre").click(function(){
        $("#test").empty();
        pre();
      });
    });
    
</script>
</body>
</html>